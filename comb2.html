<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Workflow Builder</title>
<style>
    :root {
        --primary-color: #6366f1;
        --secondary-color: #f3f4f6;
        --border-color: #e5e7eb;
        --text-color: #111827;
        --light-text: #6b7280;
        --node-bg: #ffffff;
        --node-selected: #f0f7ff;
        --node-border: #e5e7eb;
        --header-height: 64px;
        --connector-color: #4f7df9;
        --connector-width: 4px; /* Increased width for bold connectors */
        --status-color: #3b82f6; /* Blue color for status indicator */
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    }

    body {
        display: flex;
        flex-direction: column;
        height: 100vh;
        background-color: #f9fafb;
        color: var(--text-color);
    }

    /* Header Styles */
    header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: var(--header-height);
        padding: 0 20px;
        border-bottom: 1px solid var(--border-color);
        background-color: white;
    }

    .logo-container {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .logo {
        font-size: 24px;
        font-weight: bold;
        display: flex;
        align-items: center;
    }

    .logo-icon {
        width: 32px;
        height: 32px;
        background-color: #000;
        position: relative;
        border-radius: 4px;
        margin-right: 8px;
    }

    .logo-icon::after {
        content: '';
        position: absolute;
        width: 60%;
        height: 60%;
        background-color: var(--primary-color);
        top: 20%;
        right: -20%;
        border-radius: 2px;
    }

    .workflow-name {
        font-size: 18px;
        font-weight: 500;
        border: none;
        background: transparent;
        padding: 5px 10px;
        border-radius: 4px;
        margin-left: 10px;
        cursor: text;
    }

    .workflow-name:hover, .workflow-name:focus {
        background-color: var(--secondary-color);
        outline: none;
    }

    .header-buttons {
        display: flex;
        gap: 10px;
    }

    .btn {
        padding: 8px 16px;
        border-radius: 6px;
        border: 1px solid var(--border-color);
        background-color: white;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 6px;
        transition: all 0.2s;
    }

    .btn:hover {
        background-color: var(--secondary-color);
    }

    .btn-primary {
        background-color: var(--primary-color);
        color: white;
        border: none;
    }

    .btn-primary:hover {
        background-color: #5254cc;
    }

    .btn-icon {
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* Main Content */
    .main-content {
        display: flex;
        flex: 1;
        overflow: hidden;
    }

    /* Workflow Area */
    .workflow-area {
        flex: 1;
        padding: 30px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .workflow-container {
        width: 100%;
        max-width: 1000px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 20px;
        position: relative;
    }

    .branching-container {
        display: flex;
        justify-content: space-between;
        width: 100%;
        max-width: 1000px;
        margin-top: 10px;
        position: relative;
    }

    .branch {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 45%;
        gap: 20px;
        position: relative;
    }

    /* New connector styles with animation */
    .connector-container {
        position: relative;
        width: 100%;
        height: 40px;
        margin: 0;
    }

    .connector-path {
        fill: none;
        stroke: var(--connector-color);
        stroke-width: var(--connector-width);
        stroke-dasharray: 5, 5;
        animation: flowAnimation 1s linear infinite;
    }

    @keyframes flowAnimation {
        to {
            stroke-dashoffset: -10;
        }
    }

    /* Branching connectors */
    .branching-connector {
        position: absolute;
        top: -90px; /* Adjust this value to position the SVG correctly */
        left: 0;
        width: 100%;
        height: 100px;
        z-index: -1;
    }

    /* Vertical connector after branching */
    .vertical-connector {
        position: relative;
        width: var(--connector-width); /* Using the variable for consistent width */
        height: 40px;
        background-color: var(--connector-color);
        margin: 0 auto;
        stroke-dasharray: 5, 5;
        animation: pulseAnimation 1.5s ease-in-out infinite;
    }

    @keyframes pulseAnimation {
        0% { opacity: 0.6; }
        50% { opacity: 1; }
        100% { opacity: 0.6; }
    }

    .workflow-node {
        width: 100%;
        background-color: var(--node-bg);
        border: 1px solid var(--node-border);
        border-radius: 8px;
        padding: 20px;
        cursor: pointer;
        transition: all 0.2s;
        position: relative;
        z-index: 5;
    }

    .workflow-node.selected {
        border-color: var(--primary-color);
        background-color: var(--node-selected);
        box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);
    }

    .node-number {
        position: absolute;
        left: -40px;
        top: 50%;
        transform: translateY(-50%);
        width: 24px;
        height: 24px;
        border-radius: 50%;
        background-color: var(--secondary-color);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        color: var(--light-text);
    }

    .node-content {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .node-icon {
        width: 32px;
        height: 32px;
        border-radius: 6px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 16px;
    }

    .node-title {
        font-size: 16px;
        font-weight: 500;
    }

    .node-details {
        font-size: 14px;
        color: var(--light-text);
        margin-top: 5px;
    }

    .node-input {
        margin-top: 15px;
        width: 100%;
        padding: 10px;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        font-size: 14px;
    }

    .add-node-btn {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: white;
        border: 1px solid var(--border-color);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: 24px;
        margin-top: 10px;
        transition: all 0.2s;
    }

    .add-node-btn:hover {
        background-color: var(--secondary-color);
    }

    /* Node Output Button */
    .node-output-btn {
        position: absolute;
        top: 10px;
        right: 40px;
        width: 28px;
        height: 28px;
        border-radius: 4px;
        background-color: #f3f4f6;
        border: none;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: 14px;
        color: #6b7280;
        transition: all 0.2s;
        z-index: 5;
    }

    .node-output-btn:hover {
        background-color: #e5e7eb;
        color: var(--primary-color);
    }

    /* Node Modal */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.2s;
    }

    .modal-overlay.active {
        opacity: 1;
        pointer-events: auto;
    }

    .modal {
        background-color: white;
        border-radius: 8px;
        width: 90%;
        max-width: 500px;
        max-height: 80vh;
        overflow-y: auto;
        padding: 20px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }

    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    .modal-title {
        font-size: 18px;
        font-weight: 600;
    }

    .close-modal {
        background: none;
        border: none;
        font-size: 20px;
        cursor: pointer;
        color: var(--light-text);
    }

    .node-options {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 10px;
    }

    .node-option {
        padding: 15px;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .node-option:hover {
        border-color: var(--primary-color);
        background-color: var(--node-selected);
    }

    /* Output Modal */
    .output-modal .modal-content {
        padding: 10px 0;
    }

    .output-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 0;
        border-bottom: 1px solid var(--border-color);
    }

    .output-title {
        font-size: 16px;
        font-weight: 600;
    }

    .output-data {
        margin-top: 15px;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        overflow: hidden;
    }

    .output-table {
        width: 100%;
        border-collapse: collapse;
    }

    .output-table th {
        background-color: #f9fafb;
        text-align: left;
        padding: 10px;
        border-bottom: 1px solid var(--border-color);
        font-size: 14px;
        font-weight: 500;
    }

    .output-table td {
        padding: 10px;
        border-bottom: 1px solid var(--border-color);
        font-size: 14px;
    }

    .output-table tr:last-child td {
        border-bottom: none;
    }

    /* Config Panel */
    .config-panel {
        width: 350px;
        border-left: 1px solid var(--border-color);
        background-color: white;
        overflow-y: auto;
        transform: translateX(100%);
        transition: transform 0.3s;
    }

    .config-panel.active {
        transform: translateX(0);
    }

    .config-header {
        padding: 20px;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .config-title {
        font-size: 16px;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .close-config {
        background: none;
        border: none;
        font-size: 20px;
        cursor: pointer;
        color: var(--light-text);
    }

    .config-content {
        padding: 20px;
    }

    .form-group {
        margin-bottom: 20px;
    }

    .form-label {
        display: block;
        margin-bottom: 8px;
        font-size: 14px;
        font-weight: 500;
    }

    .required::after {
        content: '*';
        color: red;
        margin-left: 4px;
    }

    .form-input {
        width: 100%;
        padding: 10px;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        font-size: 14px;
    }

    .form-select {
        width: 100%;
        padding: 10px;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        font-size: 14px;
        background-color: white;
    }

    .form-checkbox {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 10px;
    }

    .save-btn {
        width: 100%;
        padding: 10px;
        background-color: var(--primary-color);
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        margin-top: 20px;
    }

    /* Run Animation */
    .run-overlay {
        position: fixed;
        top: 20px;
        right: 20px;
        width: 250px;
        height: auto;
        padding: 20px;
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: flex-start;
        gap: 15px;
        z-index: 2000;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s;
    }

    .run-animation {
        width: 30px;
        height: 30px;
        border: 3px solid var(--secondary-color);
        border-top: 3px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 0;
    }

    .run-text {
        font-size: 16px;
        font-weight: 500;
        color: var(--text-color);
    }

    /* Node in-progress animation during run */
    @keyframes pulse {
        0% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.4); }
        70% { box-shadow: 0 0 0 10px rgba(99, 102, 241, 0); }
        100% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0); }
    }

    .node-active {
        animation: pulse 1.5s infinite;
        border-color: var(--primary-color);
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    /* Node Colors */
    .trigger-node { background-color: #f97316; }
    .get-contact { background-color: #f97316; }
    .search-people { background-color: #818cf8; }
    .column-split { background-color: #fbbf24; }
    .merge-data { background-color: #10b981; }
    .filter-data { background-color: #8b5cf6; }
    .create-update-contact { background-color: #f43f5e; }
    .enrich-people { background-color: #06b6d4; }
    .csv-write { background-color: #22c55e; }
    .remove-duplicates { background-color: #ec4899; }
    .create-update-company { background-color: #f43f5e; }
    .search-company { background-color: #f97316; }
    .enrich-company { background-color: #06b6d4; }
    .classifier { background-color: #8b5cf6; }
    .ask-ai { background-color: #10b981; }
    .fetch-linkedin { background-color: #0077b5; }
    .group-data { background-color: #fbbf24; }
    .condition { background-color: #ec4899; }

    .delete-node-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        background-color: #f3f4f6;
        border: none;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: 16px;
        color: #6b7280;
        transition: all 0.2s;
        z-index: 5;
    }

    .delete-node-btn:hover {
        background-color: #fee2e2;
        color: #ef4444;
    }

    /* Status indicator for completed nodes */
    .node-status-indicator {
        position: absolute;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background-color: var(--status-color);
        top: 10px;
        left: 10px;
        display: none;
    }

    .completed .node-status-indicator {
        display: block;
    }

    /* Dropdown styles for multi-select */
    .dropdown-container {
        position: relative;
        width: 100%;
    }

    .dropdown-select {
        width: 100%;
        padding: 10px;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        background-color: white;
        display: flex;
        align-items: center;
        justify-content: space-between;
        cursor: pointer;
        font-size: 14px;
    }

    .dropdown-select:hover {
        border-color: var(--primary-color);
    }

    .dropdown-options {
        position: absolute;
        top: 100%;
        left: 0;
        width: 100%;
        max-height: 200px;
        overflow-y: auto;
        background-color: white;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        margin-top: 5px;
        z-index: 10;
        display: none;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .dropdown-options.active {
        display: block;
    }

    .dropdown-option {
        padding: 10px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .dropdown-option:hover {
        background-color: var(--secondary-color);
    }

    .dropdown-option.selected {
        background-color: rgba(99, 102, 241, 0.1);
    }

    .dropdown-option-checkbox {
        width: 16px;
        height: 16px;
        border: 1px solid var(--border-color);
        border-radius: 3px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .dropdown-option.selected .dropdown-option-checkbox {
        background-color: var(--primary-color);
        border-color: var(--primary-color);
    }

    .dropdown-option.selected .dropdown-option-checkbox::after {
        content: '✓';
        color: white;
        font-size: 12px;
    }

    .dropdown-selected-items {
        display: flex;
        flex-wrap: wrap;
        gap: 5px;
        margin-top: 5px;
    }

    .dropdown-selected-item {
        background-color: var(--secondary-color);
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        display: flex;
        align-items: center;
        gap: 5px;
    }

    .dropdown-selected-item-remove {
        cursor: pointer;
        font-weight: bold;
    }

    .dropdown-footer {
        display: flex;
        justify-content: space-between;
        padding: 10px;
        border-top: 1px solid var(--border-color);
    }

    .dropdown-footer button {
        background: none;
        border: none;
        cursor: pointer;
        font-size: 12px;
        color: var(--primary-color);
    }

    .dropdown-footer button:hover {
        text-decoration: underline;
    }

    .section-title {
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 15px;
        margin-top: 20px;
    }

    /* Workflow tabs */
    .workflow-tabs {
        display: flex;
        border-bottom: 1px solid var(--border-color);
        margin-bottom: 20px;
        width: 100%;
        max-width: 1000px;
    }

    .workflow-tab {
        padding: 10px 20px;
        cursor: pointer;
        border-bottom: 2px solid transparent;
        font-weight: 500;
        transition: all 0.2s;
    }

    .workflow-tab:hover {
        color: var(--primary-color);
    }

    .workflow-tab.active {
        border-bottom-color: var(--primary-color);
        color: var(--primary-color);
    }

    /* Workflow containers */
    .workflow-content {
        display: none;
        width: 100%;
    }

    .workflow-content.active {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    /* Trigger badge */
    .trigger-badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background-color: #f97316;
        color: white;
        padding: 4px 10px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 500;
        margin-bottom: 10px;
    }

    .trigger-badge svg {
        margin-right: 4px;
    }
</style>
</head>
<body>
<!-- Header -->
<header>
    <div class="logo-container">
        <div class="logo">
            <div class="logo-icon"></div>
            nRev
        </div>
        <input type="text" class="workflow-name" value="Untitled Workflow" spellcheck="false">
    </div>
    <div class="header-buttons">
        <button class="btn">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 20h9"></path>
                <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
            </svg>
            Editor
        </button>
        <button class="btn btn-primary" id="run-btn">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
            Run
        </button>
        <button class="btn">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
                <polyline points="16 6 12 2 8 6"></polyline>
                <line x1="12" y1="2" x2="12" y2="15"></line>
            </svg>
            Share
        </button>
    </div>
</header>

<!-- Main Content -->
<div class="main-content">
    <!-- Workflow Area -->
    <div class="workflow-area">
        <!-- Workflow Tabs -->
        <div class="workflow-tabs">
            <div class="workflow-tab" data-workflow="workflow1">Workflow 1</div>
            <div class="workflow-tab" data-workflow="workflow2">Workflow 2</div>
            <div class="workflow-tab active" data-workflow="workflow3">Workflow 3</div>
        </div>

        <!-- Workflow 1 Content (Original) -->
        <div class="workflow-content" id="workflow1">
            <div class="workflow-container" id="workflow-container-1">
                <!-- Static nodes for our original workflow -->
            </div>
        </div>

        <!-- Workflow 2 Content (New) -->
        <div class="workflow-content" id="workflow2">
            <div class="workflow-container" id="workflow-container-2">
                <!-- New workflow structure will be added here -->
            </div>
        </div>

        <!-- Workflow 3 Content (Newest) -->
        <div class="workflow-content active" id="workflow3">
            <div class="workflow-container" id="workflow-container-3">
                <!-- Workflow 3 structure will be added here -->
            </div>
        </div>
    </div>

    <!-- Config Panel -->
    <div class="config-panel" id="config-panel">
        <div class="config-header">
            <div class="config-title" id="config-title">
                <div class="node-icon get-contact">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </div>
                Get Contact
            </div>
            <button class="close-config" id="close-config">×</button>
        </div>
        <div class="config-content" id="config-content">
            <!-- Config form will be added here dynamically -->
        </div>
    </div>
</div>

<!-- Output Modals for each node -->
<div class="modal-overlay" id="output-modal-get-contact">
    <div class="modal output-modal">
        <div class="modal-header">
            <div class="modal-title">Get Contact Output</div>
            <button class="close-modal" onclick="closeOutputModal('output-modal-get-contact')">×</button>
        </div>
        <div class="modal-content">
            <div class="output-data">
                <table class="output-table">
                    <thead>
                        <tr>
                            <th>Email</th>
                            <th>Name</th>
                            <th>Company</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>johndoe@gmail.com</td>
                            <td>John Doe</td>
                            <td>Acme Corp</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="output-modal-search-people">
    <div class="modal output-modal">
        <div class="modal-header">
            <div class="modal-title">Search People Output</div>
            <button class="close-modal" onclick="closeOutputModal('output-modal-search-people')">×</button>
        </div>
        <div class="modal-content">
            <div class="output-data">
                <table class="output-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Col1</th>
                            <th>Col2</th>
                            <th>Company</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Jane Smith</td>
                            <td>Marketing</td>
                            <td>5 years</td>
                            <td>XYZ Corp</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="output-modal-column-split">
    <div class="modal output-modal">
        <div class="modal-header">
            <div class="modal-title">Column to Split Output</div>
            <button class="close-modal" onclick="closeOutputModal('output-modal-column-split')">×</button>
        </div>
        <div class="modal-content">
            <div class="output-data">
                <table class="output-table">
                    <thead>
                        <tr>
                            <th>Experience</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Senior Developer</td>
                            <td>5 years</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="output-modal-merge-data">
    <div class="modal output-modal">
        <div class="modal-header">
            <div class="modal-title">Merge Data Output</div>
            <button class="close-modal" onclick="closeOutputModal('output-modal-merge-data')">×</button>
        </div>
        <div class="modal-content">
            <div class="output-data">
                <table class="output-table">
                    <thead>
                        <tr>
                            <th>Experience</th>
                            <th>Company</th>
                            <th>Source</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Senior Developer</td>
                            <td>Acme Corp</td>
                            <td>Inner Join</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="output-modal-filter-data">
    <div class="modal output-modal">
        <div class="modal-header">
            <div class="modal-title">Filter Data Output</div>
            <button class="close-modal" onclick="closeOutputModal('output-modal-filter-data')">×</button>
        </div>
        <div class="modal-content">
            <div class="output-data">
                <table class="output-table">
                    <thead>
                        <tr>
                            <th>Experience</th>
                            <th>Company</th>
                            <th>Filter Result</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Senior Developer</td>
                            <td>Acme Corp</td>
                            <td>True</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="output-modal-create-update-contact">
    <div class="modal output-modal">
        <div class="modal-header">
            <div class="modal-title">Create/Update Contact Output</div>
            <button class="close-modal" onclick="closeOutputModal('output-modal-create-update-contact')">×</button>
        </div>
        <div class="modal-content">
            <div class="output-data">
                <table class="output-table">
                    <thead>
                        <tr>
                            <th>Email</th>
                            <th>Name</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>johndoe@gmail.com</td>
                            <td>John Doe</td>
                            <td>Updated</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="output-modal-enrich-people">
    <div class="modal output-modal">
        <div class="modal-header">
            <div class="modal-title">Enrich People Output</div>
            <button class="close-modal" onclick="closeOutputModal('output-modal-enrich-people')">×</button>
        </div>
        <div class="modal-content">
            <div class="output-data">
                <table class="output-table">
                    <thead>
                        <tr>
                            <th>Email</th>
                            <th>Name</th>
                            <th>Company</th>
                            <th>Col1</th>
                            <th>Col2</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>johndoe@gmail.com</td>
                            <td>John Doe</td>
                            <td>XYZ Inc</td>
                            <td>Senior Developer</td>
                            <td>San Francisco</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- New output modals for Workflow 3 -->
<div class="modal-overlay" id="output-modal-search-company">
    <div class="modal output-modal">
        <div class="modal-header">
            <div class="modal-title">Search Company Output</div>
            <button class="close-modal" onclick="closeOutputModal('output-modal-search-company')">×</button>
        </div>
        <div class="modal-content">
            <div class="output-data">
                <table class="output-table">
                    <thead>
                        <tr>
                            <th>Company</th>
                            <th>Twitter Bio</th>
                            <th>Website URL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Acme Corp</td>
                            <td>Leading provider of innovative solutions</td>
                            <td>https://acmecorp.com</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="output-modal-enrich-company">
    <div class="modal output-modal">
        <div class="modal-header">
            <div class="modal-title">Enrich Company Output</div>
            <button class="close-modal" onclick="closeOutputModal('output-modal-enrich-company')">×</button>
        </div>
        <div class="modal-content">
            <div class="output-data">
                <table class="output-table">
                    <thead>
                        <tr>
                            <th>Company</th>
                            <th>domain1</th>
                            <th>domain2</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Acme Corp</td>
                            <td>acmecorp.com</td>
                            <td>acme-inc.net</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="output-modal-classifier">
    <div class="modal output-modal">
        <div class="modal-header">
            <div class="modal-title">Classifier Output</div>
            <button class="close-modal" onclick="closeOutputModal('output-modal-classifier')">×</button>
        </div>
        <div class="modal-content">
            <div class="output-data">
                <table class="output-table">
                    <thead>
                        <tr>
                            <th>Input</th>
                            <th>Classification</th>
                            <th>Confidence</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>domain1: acmecorp.com</td>
                            <td>Technology</td>
                            <td>87%</td>
                        </tr>
                        <tr>
                            <td>domain2: acme-inc.net</td>
                            <td>Technology</td>
                            <td>82%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="output-modal-ask-ai">
    <div class="modal output-modal">
        <div class="modal-header">
            <div class="modal-title">Ask AI Output</div>
            <button class="close-modal" onclick="closeOutputModal('output-modal-ask-ai')">×</button>
        </div>
        <div class="modal-content">
            <div class="output-data">
                <table class="output-table">
                    <thead>
                        <tr>
                            <th>Action</th>
                            <th>AI Output</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Summarize</td>
                            <td>Acme Corp is a technology company with multiple domains. They specialize in innovative solutions and have a strong online presence.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="output-modal-fetch-linkedin">
    <div class="modal output-modal">
        <div class="modal-header">
            <div class="modal-title">Fetch LinkedIn Output</div>
            <button class="close-modal" onclick="closeOutputModal('output-modal-fetch-linkedin')">×</button>
        </div>
        <div class="modal-content">
            <div class="output-data">
                <table class="output-table">
                    <thead>
                        <tr>
                            <th>URL</th>
                            <th>Profile Data</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>url1</td>
                            <td>LinkedIn profile data for John Smith, CEO at Acme Corp</td>
                        </tr>
                        <tr>
                            <td>url2</td>
                            <td>LinkedIn profile data for Jane Doe, CTO at Acme Corp</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="output-modal-group-data">
    <div class="modal output-modal">
        <div class="modal-header">
            <div class="modal-title">Group Data Output</div>
            <button class="close-modal" onclick="closeOutputModal('output-modal-group-data')">×</button>
        </div>
        <div class="modal-content">
            <div class="output-data">
                <table class="output-table">
                    <thead>
                        <tr>
                            <th>Column 3</th>
                            <th>Grouped Data</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Technology</td>
                            <td>3 records</td>
                        </tr>
                        <tr>
                            <td>Marketing</td>
                            <td>2 records</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="output-modal-condition">
    <div class="modal output-modal">
        <div class="modal-header">
            <div class="modal-title">Condition Output</div>
            <button class="close-modal" onclick="closeOutputModal('output-modal-condition')">×</button>
        </div>
        <div class="modal-content">
            <div class="output-data">
                <table class="output-table">
                    <thead>
                        <tr>
                            <th>Condition</th>
                            <th>Result</th>
                            <th>Path</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Input is equal to Value</td>
                            <td>True</td>
                            <td>True path</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Run Animation Overlay -->
<div class="run-overlay" id="run-overlay">
    <div class="run-animation"></div>
    <div class="run-text">Running workflow...</div>
</div>

<script>
    // DOM Elements
    const workflowContainer1 = document.getElementById('workflow-container-1');
    const workflowContainer2 = document.getElementById('workflow-container-2');
    const workflowContainer3 = document.getElementById('workflow-container-3');
    const configPanel = document.getElementById('config-panel');
    const closeConfig = document.getElementById('close-config');
    const configTitle = document.getElementById('config-title');
    const configContent = document.getElementById('config-content');
    const runBtn = document.getElementById('run-btn');
    const runOverlay = document.getElementById('run-overlay');
    const workflowTabs = document.querySelectorAll('.workflow-tab');
    const workflowContents = document.querySelectorAll('.workflow-content');

    // State
    let selectedNodeId = null;
    let currentWorkflow = 'workflow3';
    
    // Node definitions for original workflow
    const workflow1Nodes = [
        {
            id: 'get-contact',
            name: 'Get Contact',
            type: 'trigger-node',
            details: 'johndoe@gmail.com',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Company Domain</label>
                    <input type="text" class="form-input" value="johndoe@gmail.com">
                </div>
                <div class="form-group">
                    <label class="form-label">Columns to include</label>
                    <div class="dropdown-container" id="get-contact-columns">
                        <div class="dropdown-select">
                            <span>Select columns</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option" data-value="twitter_bio">
                                <span>Twitter Bio</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option" data-value="website_url">
                                <span>Website URL</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option" data-value="linkedin_url">
                                <span>LinkedIn URL</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option" data-value="company_name">
                                <span>Company Name</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option" data-value="job_title">
                                <span>Job Title</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-footer">
                                <button class="select-all-btn">Select All</button>
                                <button class="deselect-all-btn">Deselect All</button>
                            </div>
                        </div>
                        <div class="dropdown-selected-items"></div>
                    </div>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'enrich-people',
            name: 'Enrich People',
            type: 'enrich-people',
            details: 'Col1, Col2',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="23" y1="11" x2="17" y2="11"></line></svg>',
            config: `
                <div class="section-title">Person Details</div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="text" class="form-input" placeholder="Comma separated email" value="johndoe@gmail.com">
                </div>
                <div class="form-group">
                    <label class="form-label">LinkedIn URL</label>
                    <input type="text" class="form-input" placeholder="Comma separated LinkedIn URL">
                </div>
                <div class="section-title">Enrichment Fields</div>
                <div class="form-group">
                    <label class="form-label required">Enrichment Fields</label>
                    <div class="dropdown-container" id="enrich-people-fields">
                        <div class="dropdown-select">
                            <span>Select fields</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option" data-value="column_1">
                                <span>Column 1</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option" data-value="column_2">
                                <span>Column 2</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option" data-value="column_3">
                                <span>Column 3</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option" data-value="job_title">
                                <span>Job Title</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option" data-value="location">
                                <span>Location</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-footer">
                                <button class="select-all-btn">Select All</button>
                                <button class="deselect-all-btn">Deselect All</button>
                            </div>
                        </div>
                        <div class="dropdown-selected-items"></div>
                    </div>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'filter-data',
            name: 'Filter Data',
            type: 'filter-data',
            details: 'Person Company from enrichment not same as Company from contact',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Filter Condition</label>
                    <textarea class="form-input" rows="3">Person Company from enrichment not same as Company from contact</textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Add Another Condition</label>
                    <button class="btn btn-outline">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 5v14M5 12h14"></path>
                        </svg>
                        Add Condition
                    </button>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'csv-write',
            name: 'CSV Write',
            type: 'csv-write',
            details: 'Col1, Col2, Col3',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">File Name</label>
                    <input type="text" class="form-input" value="export.csv">
                </div>
                <div class="form-group">
                    <label class="form-label required">Fields to Export</label>
                    <div class="multi-select-wrapper">
                        <div class="multi-select-display">
                            <span class="multi-select-tag">Col1</span>
                            <span class="multi-select-tag">Col2</span>
                            <span class="multi-select-tag">Col3</span>
                        </div>
                    </div>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'remove-duplicates',
            name: 'Remove Duplicates',
            type: 'remove-duplicates',
            details: '-/-',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Fields to Compare</label>
                    <div class="multi-select-wrapper">
                        <div class="multi-select-display">
                            <span class="multi-select-tag">Email</span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">When Duplicates Found</label>
                    <div class="form-select-wrapper">
                        <select class="form-select">
                            <option>Keep First</option>
                            <option>Keep Last</option>
                            <option>Keep All</option>
                        </select>
                    </div>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'create-update-company-1',
            name: 'Create/Update a Company',
            type: 'create-update-company',
            details: 'company_domain',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Company Domain</label>
                    <input type="text" class="form-input" value="company_domain">
                </div>
                <div class="form-group">
                    <label class="form-label">If Company Exists</label>
                    <div class="form-select-wrapper">
                        <select class="form-select">
                            <option>Update</option>
                            <option>Skip</option>
                            <option>Create New</option>
                        </select>
                    </div>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'create-update-company-2',
            name: 'Create/Update a Company',
            type: 'create-update-company',
            details: 'company_domain',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Company Domain</label>
                    <input type="text" class="form-input" value="company_domain">
                </div>
                <div class="form-group">
                    <label class="form-label">If Company Exists</label>
                    <div class="form-select-wrapper">
                        <select class="form-select">
                            <option>Update</option>
                            <option>Skip</option>
                            <option>Create New</option>
                        </select>
                    </div>
                </div>
                <button class="save-btn">Save</button>
            `
        }
    ];

    // Node definitions for new workflow
    const workflow2Nodes = [
        {
            id: 'get-contact-2',
            name: 'Get Contact',
            type: 'get-contact',
            details: 'johndoe@gmail.com',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Email</label>
                    <input type="text" class="form-input" value="johndoe@gmail.com">
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'search-people',
            name: 'Search People',
            type: 'search-people',
            details: 'Col1, Col2',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Search Fields</label>
                    <div class="dropdown-container" id="search-people-fields">
                        <div class="dropdown-select">
                            <span>Select fields</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option" data-value="col1">
                                <span>Col1</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option" data-value="col2">
                                <span>Col2</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                        </div>
                        <div class="dropdown-selected-items"></div>
                    </div>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'column-split-1',
            name: 'Column to Split',
            type: 'column-split',
            details: 'Experience',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="12" y1="3" x2="12" y2="21"></line></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Field to Split</label>
                    <select class="form-select">
                        <option selected>Experience</option>
                        <option>Company</option>
                        <option>Name</option>
                    </select>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'column-split-2',
            name: 'Column to Split',
            type: 'column-split',
            details: 'Experience',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="12" y1="3" x2="12" y2="21"></line></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Field to Split</label>
                    <select class="form-select">
                        <option selected>Experience</option>
                        <option>Company</option>
                        <option>Name</option>
                    </select>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'merge-data',
            name: 'Merge Data',
            type: 'merge-data',
            details: 'Inner Join - Experience, Company',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Join Type</label>
                    <select class="form-select">
                        <option selected>Inner Join</option>
                        <option>Left Join</option>
                        <option>Right Join</option>
                        <option>Full Join</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label required">Join Fields</label>
                    <div class="dropdown-container" id="merge-data-fields">
                        <div class="dropdown-select">
                            <span>Select fields</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option selected" data-value="experience">
                                <span>Experience</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option selected" data-value="company">
                                <span>Company</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                        </div>
                        <div class="dropdown-selected-items">
                            <div class="dropdown-selected-item">
                                <span>Experience</span>
                                <span class="dropdown-selected-item-remove" data-value="experience">×</span>
                            </div>
                            <div class="dropdown-selected-item">
                                <span>Company</span>
                                <span class="dropdown-selected-item-remove" data-value="company">×</span>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'filter-data-2',
            name: 'Filter Data',
            type: 'filter-data',
            details: 'start1 <= end2 AND start2 <= end1',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Filter Condition</label>
                    <textarea class="form-input" rows="3">start1 <= end2 AND start2 <= end1</textarea>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'create-update-contact',
            name: 'Create/Update a Contact',
            type: 'create-update-contact',
            details: 'johndoe@gmail.com',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Email</label>
                    <input type="text" class="form-input" value="johndoe@gmail.com">
                </div>
                <div class="form-group">
                    <label class="form-label">If Contact Exists</label>
                    <select class="form-select">
                        <option selected>Update</option>
                        <option>Skip</option>
                        <option>Create New</option>
                    </select>
                </div>
                <button class="save-btn">Save</button>
            `
        }
    ];

    // Node definitions for workflow 3
    const workflow3Nodes = [
        {
            id: 'search-company',
            name: 'Search Company',
            type: 'search-company',
            details: 'Twitter bio, website URL',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Search Fields</label>
                    <div class="dropdown-container" id="search-company-fields">
                        <div class="dropdown-select">
                            <span>Select fields</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option selected" data-value="twitter_bio">
                                <span>Twitter Bio</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option selected" data-value="website_url">
                                <span>Website URL</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                        </div>
                        <div class="dropdown-selected-items">
                            <div class="dropdown-selected-item">
                                <span>Twitter Bio</span>
                                <span class="dropdown-selected-item-remove" data-value="twitter_bio">×</span>
                            </div>
                            <div class="dropdown-selected-item">
                                <span>Website URL</span>
                                <span class="dropdown-selected-item-remove" data-value="website_url">×</span>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'enrich-company',
            name: 'Enrich Company',
            type: 'enrich-company',
            details: 'domain1, domain2',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path><line x1="12" y1="7" x2="12" y2="7.01"></line><line x1="12" y1="11" x2="12" y2="11.01"></line><line x1="12" y1="15" x2="12" y2="15.01"></line></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Enrichment Fields</label>
                    <div class="dropdown-container" id="enrich-company-fields">
                        <div class="dropdown-select">
                            <span>Select fields</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option selected" data-value="domain1">
                                <span>domain1</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option selected" data-value="domain2">
                                <span>domain2</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                        </div>
                        <div class="dropdown-selected-items">
                            <div class="dropdown-selected-item">
                                <span>domain1</span>
                                <span class="dropdown-selected-item-remove" data-value="domain1">×</span>
                            </div>
                            <div class="dropdown-selected-item">
                                <span>domain2</span>
                                <span class="dropdown-selected-item-remove" data-value="domain2">×</span>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'search-people-3',
            name: 'Search People',
            type: 'search-people',
            details: 'Col1, Col2',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Search Fields</label>
                    <div class="dropdown-container" id="search-people-fields-3">
                        <div class="dropdown-select">
                            <span>Select fields</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option selected" data-value="col1">
                                <span>Col1</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option selected" data-value="col2">
                                <span>Col2</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                        </div>
                        <div class="dropdown-selected-items">
                            <div class="dropdown-selected-item">
                                <span>Col1</span>
                                <span class="dropdown-selected-item-remove" data-value="col1">×</span>
                            </div>
                            <div class="dropdown-selected-item">
                                <span>Col2</span>
                                <span class="dropdown-selected-item-remove" data-value="col2">×</span>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'enrich-people-3',
            name: 'Enrich People',
            type: 'enrich-people',
            details: 'Col1, Col2',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="23" y1="11" x2="17" y2="11"></line></svg>',
            config: `
                <div class="section-title">Person Details</div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="text" class="form-input" placeholder="Comma separated email">
                </div>
                <div class="section-title">Enrichment Fields</div>
                <div class="form-group">
                    <label class="form-label required">Enrichment Fields</label>
                    <div class="dropdown-container" id="enrich-people-fields-3">
                        <div class="dropdown-select">
                            <span>Select fields</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option selected" data-value="col1">
                                <span>Col1</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option selected" data-value="col2">
                                <span>Col2</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                        </div>
                        <div class="dropdown-selected-items">
                            <div class="dropdown-selected-item">
                                <span>Col1</span>
                                <span class="dropdown-selected-item-remove" data-value="col1">×</span>
                            </div>
                            <div class="dropdown-selected-item">
                                <span>Col2</span>
                                <span class="dropdown-selected-item-remove" data-value="col2">×</span>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'classifier',
            name: 'Classifier',
            type: 'classifier',
            details: 'domain1, domain2',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"></path><line x1="4" y1="22" x2="4" y2="15"></line></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Classification Fields</label>
                    <div class="dropdown-container" id="classifier-fields">
                        <div class="dropdown-select">
                            <span>Select fields</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option selected" data-value="domain1">
                                <span>domain1</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option selected" data-value="domain2">
                                <span>domain2</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                        </div>
                        <div class="dropdown-selected-items">
                            <div class="dropdown-selected-item">
                                <span>domain1</span>
                                <span class="dropdown-selected-item-remove" data-value="domain1">×</span>
                            </div>
                            <div class="dropdown-selected-item">
                                <span>domain2</span>
                                <span class="dropdown-selected-item-remove" data-value="domain2">×</span>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'ask-ai-1',
            name: 'Ask AI',
            type: 'ask-ai',
            details: 'Summarize / AI Output',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Action</label>
                    <select class="form-select">
                        <option selected>Summarize</option>
                        <option>Analyze</option>
                        <option>Extract</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Prompt</label>
                    <textarea class="form-input" rows="3">Summarize the company information</textarea>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'filter-data-3',
            name: 'Filter Data',
            type: 'filter-data',
            details: 'Input is equal to Value',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Filter Condition</label>
                    <textarea class="form-input" rows="3">Input is equal to Value</textarea>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'fetch-linkedin',
            name: 'Fetch LinkedIn',
            type: 'fetch-linkedin',
            details: 'url1, url2',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">LinkedIn URLs</label>
                    <div class="dropdown-container" id="linkedin-urls">
                        <div class="dropdown-select">
                            <span>Select URLs</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="dropdown-options">
                            <div class="dropdown-option selected" data-value="url1">
                                <span>url1</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                            <div class="dropdown-option selected" data-value="url2">
                                <span>url2</span>
                                <div class="dropdown-option-checkbox"></div>
                            </div>
                        </div>
                        <div class="dropdown-selected-items">
                            <div class="dropdown-selected-item">
                                <span>url1</span>
                                <span class="dropdown-selected-item-remove" data-value="url1">×</span>
                            </div>
                            <div class="dropdown-selected-item">
                                <span>url2</span>
                                <span class="dropdown-selected-item-remove" data-value="url2">×</span>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'ask-ai-2',
            name: 'Ask AI',
            type: 'ask-ai',
            details: 'Summarize / AI Output',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Action</label>
                    <select class="form-select">
                        <option selected>Summarize</option>
                        <option>Analyze</option>
                        <option>Extract</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Prompt</label>
                    <textarea class="form-input" rows="3">Summarize the LinkedIn profile</textarea>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'ask-ai-3',
            name: 'Ask AI',
            type: 'ask-ai',
            details: 'Summarize / AI Output',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Action</label>
                    <select class="form-select">
                        <option selected>Summarize</option>
                        <option>Analyze</option>
                        <option>Extract</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Prompt</label>
                    <textarea class="form-input" rows="3">Summarize the LinkedIn profile</textarea>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'merge-data-3',
            name: 'Merge Data',
            type: 'merge-data',
            details: 'Join type: Matching Fields',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Join Type</label>
                    <select class="form-select">
                        <option selected>Matching Fields</option>
                        <option>Inner Join</option>
                        <option>Left Join</option>
                        <option>Right Join</option>
                    </select>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'group-data',
            name: 'Group Data',
            type: 'group-data',
            details: 'Column 3, Append',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Group By</label>
                    <select class="form-select">
                        <option selected>Column 3</option>
                        <option>Column 1</option>
                        <option>Column 2</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label required">Aggregation</label>
                    <select class="form-select">
                        <option selected>Append</option>
                        <option>Count</option>
                        <option>Sum</option>
                        <option>Average</option>
                    </select>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'get-contact-3',
            name: 'Get Contact',
            type: 'get-contact',
            details: 'johndoe@gmail.com',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Email</label>
                    <input type="text" class="form-input" value="johndoe@gmail.com">
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'condition',
            name: 'Condition',
            type: 'condition',
            details: 'Input is equal to Value',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Condition</label>
                    <textarea class="form-input" rows="3">Input is equal to Value</textarea>
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'get-contact-true',
            name: 'Get Contact',
            type: 'get-contact',
            details: 'johndoe@gmail.com',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Email</label>
                    <input type="text" class="form-input" value="johndoe@gmail.com">
                </div>
                <button class="save-btn">Save</button>
            `
        },
        {
            id: 'get-contact-false',
            name: 'Get Contact',
            type: 'get-contact',
            details: 'johndoe@gmail.com',
            icon: '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>',
            config: `
                <div class="form-group">
                    <label class="form-label required">Email</label>
                    <input type="text" class="form-input" value="johndoe@gmail.com">
                </div>
                <button class="save-btn">Save</button>
            `
        }
    ];

    // Initialize the workflow with our predefined structure
    function initWorkflow() {
        renderWorkflow1();
        renderWorkflow2();
        renderWorkflow3();
        initDropdowns();
        initTabs();
    }

    // Render the original workflow UI
    function renderWorkflow1() {
        workflowContainer1.innerHTML = '';
        
        // First 3 nodes in sequence
        renderNode(workflowContainer1, workflow1Nodes[0], 0);
        renderCurvedConnector(workflowContainer1);
        renderNode(workflowContainer1, workflow1Nodes[1], 1);
        renderCurvedConnector(workflowContainer1);
        renderNode(workflowContainer1, workflow1Nodes[2], 2);
        
        // Create the branching container with SVG connector
        const branchingConnectorSvg = document.createElement('div');
        branchingConnectorSvg.className = 'connector-container';
        branchingConnectorSvg.innerHTML = `
            <svg width="100%" height="100" viewBox="0 0 1000 100" preserveAspectRatio="none">
                <path d="M500,0 C500,40 250,40 250,80" class="connector-path" />
                <path d="M500,0 C500,40 750,40 750,80" class="connector-path" />
            </svg>
        `;
        workflowContainer1.appendChild(branchingConnectorSvg);
        
        // Create branching container
        const branchingContainer = document.createElement('div');
        branchingContainer.className = 'branching-container';
        
        // Left branch
        const leftBranch = document.createElement('div');
        leftBranch.className = 'branch branch-left';
        
        // Right branch
        const rightBranch = document.createElement('div');
        rightBranch.className = 'branch branch-right';
        
        // Render left branch nodes
        renderNodeInContainer(leftBranch, workflow1Nodes[3], 3);
        renderCurvedConnectorInContainer(leftBranch);
        renderNodeInContainer(leftBranch, workflow1Nodes[5], 5);
        
        // Render right branch nodes
        renderNodeInContainer(rightBranch, workflow1Nodes[4], 4);
        renderCurvedConnectorInContainer(rightBranch);
        renderNodeInContainer(rightBranch, workflow1Nodes[6], 6);
        
        // Add branches to container
        branchingContainer.appendChild(leftBranch);
        branchingContainer.appendChild(rightBranch);
        
        // Add branching container to workflow
        workflowContainer1.appendChild(branchingContainer);
    }

    // Render the new workflow UI
    function renderWorkflow2() {
        workflowContainer2.innerHTML = '';
        
        // Create the branching container with SVG connector for the two trigger nodes
        const branchingContainer = document.createElement('div');
        branchingContainer.className = 'branching-container';
        
        // Left branch (Get Contact)
        const leftBranch = document.createElement('div');
        leftBranch.className = 'branch branch-left';
        
        // Add trigger badge to Get Contact
        const triggerBadge1 = document.createElement('div');
        triggerBadge1.className = 'trigger-badge';
        triggerBadge1.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M15 18l-6-6 6-6"/>
            </svg>
            Trigger
        `;
        leftBranch.appendChild(triggerBadge1);
        
        // Render Get Contact node
        renderNodeInContainer(leftBranch, workflow2Nodes[0], 0);
        renderCurvedConnectorInContainer(leftBranch);
        renderNodeInContainer(leftBranch, workflow2Nodes[2], 2);
        
        // Right branch (Search People)
        const rightBranch = document.createElement('div');
        rightBranch.className = 'branch branch-right';
        
        // Add trigger badge to Search People
        const triggerBadge2 = document.createElement('div');
        triggerBadge2.className = 'trigger-badge';
        triggerBadge2.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M15 18l-6-6 6-6"/>
            </svg>
            Trigger
        `;
        rightBranch.appendChild(triggerBadge2);
        
        // Render Search People node
        renderNodeInContainer(rightBranch, workflow2Nodes[1], 1);
        renderCurvedConnectorInContainer(rightBranch);
        renderNodeInContainer(rightBranch, workflow2Nodes[3], 3);
        
        // Add branches to container
        branchingContainer.appendChild(leftBranch);
        branchingContainer.appendChild(rightBranch);
        
        // Add branching container to workflow
        workflowContainer2.appendChild(branchingContainer);
        
        // Create merge connector
        const mergeConnectorSvg = document.createElement('div');
        mergeConnectorSvg.className = 'connector-container';
        mergeConnectorSvg.innerHTML = `
            <svg width="100%" height="100" viewBox="0 0 1000 100" preserveAspectRatio="none">
                <path d="M250,0 C250,40 500,40 500,80" class="connector-path" />
                <path d="M750,0 C750,40 500,40 500,80" class="connector-path" />
            </svg>
        `;
        workflowContainer2.appendChild(mergeConnectorSvg);
        
        // Render Merge Data node
        renderNode(workflowContainer2, workflow2Nodes[4], 4);
        renderCurvedConnector(workflowContainer2);
        
        // Render Filter Data node
        renderNode(workflowContainer2, workflow2Nodes[5], 5);
        renderCurvedConnector(workflowContainer2);
        
        // Render Create/Update Contact node
        renderNode(workflowContainer2, workflow2Nodes[6], 6);
    }

    // Render the workflow 3 UI
    function renderWorkflow3() {
        workflowContainer3.innerHTML = '';
        
        // Add trigger badge to Search Company
        const triggerBadge = document.createElement('div');
        triggerBadge.className = 'trigger-badge';
        triggerBadge.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M15 18l-6-6 6-6"/>
            </svg>
            Trigger
        `;
        workflowContainer3.appendChild(triggerBadge);
        
        // Render Search Company node
        renderNode(workflowContainer3, workflow3Nodes[0], 0);
        renderCurvedConnector(workflowContainer3);
        
        // Render Enrich Company node
        renderNode(workflowContainer3, workflow3Nodes[1], 1);
        renderCurvedConnector(workflowContainer3);
        
        // Render Search People node
        renderNode(workflowContainer3, workflow3Nodes[2], 2);
        renderCurvedConnector(workflowContainer3);
        
        // Render Enrich People node
        renderNode(workflowContainer3, workflow3Nodes[3], 3);
        renderCurvedConnector(workflowContainer3);
        
        // Render Classifier node
        renderNode(workflowContainer3, workflow3Nodes[4], 4);
        renderCurvedConnector(workflowContainer3);
        
        // Render Ask AI node
        renderNode(workflowContainer3, workflow3Nodes[5], 5);
        renderCurvedConnector(workflowContainer3);
        
        // Render Filter Data node
        renderNode(workflowContainer3, workflow3Nodes[6], 6);
        renderCurvedConnector(workflowContainer3);
        
        // Render Fetch LinkedIn node
        renderNode(workflowContainer3, workflow3Nodes[7], 7);
        
        // Create the branching container with SVG connector for the parallel Ask AI nodes
        const branchingConnectorSvg = document.createElement('div');
        branchingConnectorSvg.className = 'connector-container';
        branchingConnectorSvg.innerHTML = `
            <svg width="100%" height="100" viewBox="0 0 1000 100" preserveAspectRatio="none">
                <path d="M500,0 C500,40 250,40 250,80" class="connector-path" />
                <path d="M500,0 C500,40 750,40 750,80" class="connector-path" />
            </svg>
        `;
        workflowContainer3.appendChild(branchingConnectorSvg);
        
        // Create branching container
        const branchingContainer = document.createElement('div');
        branchingContainer.className = 'branching-container';
        
        // Left branch
        const leftBranch = document.createElement('div');
        leftBranch.className = 'branch branch-left';
        
        // Right branch
        const rightBranch = document.createElement('div');
        rightBranch.className = 'branch branch-right';
        
        // Render left branch node (Ask AI)
        renderNodeInContainer(leftBranch, workflow3Nodes[8], 8);
        
        // Render right branch node (Ask AI)
        renderNodeInContainer(rightBranch, workflow3Nodes[9], 9);
        
        // Add branches to container
        branchingContainer.appendChild(leftBranch);
        branchingContainer.appendChild(rightBranch);
        
        // Add branching container to workflow
        workflowContainer3.appendChild(branchingContainer);
        
        // Create merge connector
        const mergeConnectorSvg = document.createElement('div');
        mergeConnectorSvg.className = 'connector-container';
        mergeConnectorSvg.innerHTML = `
            <svg width="100%" height="100" viewBox="0 0 1000 100" preserveAspectRatio="none">
                <path d="M250,0 C250,40 500,40 500,80" class="connector-path" />
                <path d="M750,0 C750,40 500,40 500,80" class="connector-path" />
            </svg>
        `;
        workflowContainer3.appendChild(mergeConnectorSvg);
        
        // Render Merge Data node
        renderNode(workflowContainer3, workflow3Nodes[10], 10);
        renderCurvedConnector(workflowContainer3);
        
        // Render Group Data node
        renderNode(workflowContainer3, workflow3Nodes[11], 11);
        renderCurvedConnector(workflowContainer3);
        
        // Render Get Contact node
        renderNode(workflowContainer3, workflow3Nodes[12], 12);
        renderCurvedConnector(workflowContainer3);
        
        // Render Condition node
        renderNode(workflowContainer3, workflow3Nodes[13], 13);
        
        // Create the branching container with SVG connector for the condition paths
        const conditionConnectorSvg = document.createElement('div');
        conditionConnectorSvg.className = 'connector-container';
        conditionConnectorSvg.innerHTML = `
            <svg width="100%" height="100" viewBox="0 0 1000 100" preserveAspectRatio="none">
                <path d="M500,0 C500,40 250,40 250,80" class="connector-path" />
                <path d="M500,0 C500,40 750,40 750,80" class="connector-path" />
            </svg>
        `;
        workflowContainer3.appendChild(conditionConnectorSvg);
        
        // Create condition branching container
        const conditionContainer = document.createElement('div');
        conditionContainer.className = 'branching-container';
        
        // True branch
        const trueBranch = document.createElement('div');
        trueBranch.className = 'branch branch-left';
        
        // False branch
        const falseBranch = document.createElement('div');
        falseBranch.className = 'branch branch-right';
        
        // Add True label
        const trueLabel = document.createElement('div');
        trueLabel.style.textAlign = 'center';
        trueLabel.style.marginBottom = '10px';
        trueLabel.style.padding = '4px 12px';
        trueLabel.style.backgroundColor = '#d1fae5';
        trueLabel.style.borderRadius = '4px';
        trueLabel.style.display = 'inline-block';
        trueLabel.textContent = 'True';
        trueBranch.appendChild(trueLabel);
        
        // Add False label
        const falseLabel = document.createElement('div');
        falseLabel.style.textAlign = 'center';
        falseLabel.style.marginBottom = '10px';
        falseLabel.style.padding = '4px 12px';
        falseLabel.style.backgroundColor = '#e5e7eb';
        falseLabel.style.borderRadius = '4px';
        falseLabel.style.display = 'inline-block';
        falseLabel.textContent = 'False';
        falseBranch.appendChild(falseLabel);
        
        // Render true branch node (Get Contact)
        renderNodeInContainer(trueBranch, workflow3Nodes[14], 14);
        
        // Render false branch node (Get Contact)
        renderNodeInContainer(falseBranch, workflow3Nodes[15], 15);
        
        // Add branches to container
        conditionContainer.appendChild(trueBranch);
        conditionContainer.appendChild(falseBranch);
        
        // Add condition container to workflow
        workflowContainer3.appendChild(conditionContainer);
    }

    // Render a node into a specific container
    function renderNode(container, nodeData, index) {
        const nodeElement = createNodeElement(nodeData, index);
        container.appendChild(nodeElement);
    }

    // Render a node into a specific container (for branches)
    function renderNodeInContainer(container, nodeData, index) {
        const nodeElement = createNodeElement(nodeData, index);
        container.appendChild(nodeElement);
    }

    // Create a curved connector with SVG
    function renderCurvedConnector(container) {
        const connectorContainer = document.createElement('div');
        connectorContainer.className = 'connector-container';
        connectorContainer.innerHTML = `
            <svg width="100%" height="40" viewBox="0 0 1000 40" preserveAspectRatio="none">
                <path d="M500,0 L500,40" class="connector-path" />
            </svg>
        `;
        container.appendChild(connectorContainer);
    }

    // Create a curved connector within a container
    function renderCurvedConnectorInContainer(container) {
        const connectorContainer = document.createElement('div');
        connectorContainer.className = 'connector-container';
        connectorContainer.innerHTML = `
            <svg width="100%" height="40" viewBox="0 0 1000 40" preserveAspectRatio="none">
                <path d="M500,0 L500,40" class="connector-path" />
            </svg>
        `;
        container.appendChild(connectorContainer);
    }

    // Create a node element
    function createNodeElement(nodeData, index) {
        const nodeElement = document.createElement('div');
        nodeElement.className = `workflow-node ${selectedNodeId === nodeData.id ? 'selected' : ''}`;
        nodeElement.dataset.id = nodeData.id;
        nodeElement.dataset.index = index;
        
        // Node number
        const nodeNumber = document.createElement('div');
        nodeNumber.className = 'node-number';
        nodeNumber.textContent = index + 1;
        nodeElement.appendChild(nodeNumber);
        
        // Status indicator (blue dot)
        const statusIndicator = document.createElement('div');
        statusIndicator.className = 'node-status-indicator';
        nodeElement.appendChild(statusIndicator);
        
        // Node content
        const nodeContent = document.createElement('div');
        nodeContent.className = 'node-content';
        
        const nodeIcon = document.createElement('div');
        nodeIcon.className = `node-icon ${nodeData.type}`;
        nodeIcon.innerHTML = nodeData.icon;
        
        const nodeTitleContainer = document.createElement('div');
        
        const nodeTitle = document.createElement('div');
        nodeTitle.className = 'node-title';
        nodeTitle.textContent = nodeData.name;
        
        const nodeDetails = document.createElement('div');
        nodeDetails.className = 'node-details';
        nodeDetails.textContent = nodeData.details;
        
        nodeTitleContainer.appendChild(nodeTitle);
        nodeTitleContainer.appendChild(nodeDetails);
        
        nodeContent.appendChild(nodeIcon);
        nodeContent.appendChild(nodeTitleContainer);
        
        nodeElement.appendChild(nodeContent);
        
        // Add output button
        const outputBtn = document.createElement('button');
        outputBtn.className = 'node-output-btn';
        outputBtn.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="16 16 12 12 8 16"></polyline>
                <line x1="12" y1="12" x2="12" y2="21"></line>
                <rect x="3" y="3" width="18" height="6" rx="2"></rect>
            </svg>
        `;
        outputBtn.title = 'View output';
        outputBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            openOutputModal(nodeData.id);
        });
        nodeElement.appendChild(outputBtn);
        
        // Add click event to select node
        nodeElement.addEventListener('click', () => {
            selectNode(nodeData.id);
        });
        
        return nodeElement;
    }

    // Initialize tabs
    function initTabs() {
        workflowTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs
                workflowTabs.forEach(t => t.classList.remove('active'));
                // Add active class to clicked tab
                tab.classList.add('active');
                
                // Hide all workflow contents
                workflowContents.forEach(content => content.classList.remove('active'));
                
                // Show the selected workflow content
                const workflowId = tab.dataset.workflow;
                document.getElementById(workflowId).classList.add('active');
                
                // Update current workflow
                currentWorkflow = workflowId;
            });
        });
    }

    // Initialize dropdowns
    function initDropdowns() {
        document.addEventListener('click', function(e) {
            const dropdownSelect = e.target.closest('.dropdown-select');
            if (dropdownSelect) {
                const container = dropdownSelect.closest('.dropdown-container');
                const options = container.querySelector('.dropdown-options');
                options.classList.toggle('active');
            }

            // Handle dropdown option selection
            const dropdownOption = e.target.closest('.dropdown-option');
            if (dropdownOption) {
                dropdownOption.classList.toggle('selected');
                updateSelectedItems(dropdownOption.closest('.dropdown-container'));
            }

            // Handle select all button
            const selectAllBtn = e.target.closest('.dropdown-container');
            if (selectAllBtn) {
                const container = selectAllBtn.closest('.dropdown-container');
                const options = container.querySelectorAll('.dropdown-option');
                options.forEach(option => option.classList.add('selected'));
                updateSelectedItems(container);
            }

            // Handle deselect all button
            const deselectAllBtn = e.target.closest('.dropdown-container');
            if (deselectAllBtn) {
                const container = deselectAllBtn.closest('.dropdown-container');
                const options = container.querySelectorAll('.dropdown-option');
                options.forEach(option => option.classList.remove('selected'));
                updateSelectedItems(container);
            }

            // Close dropdown when clicking outside
            if (!e.target.closest('.dropdown-container')) {
                document.querySelectorAll('.dropdown-options.active').forEach(dropdown => {
                    dropdown.classList.remove('active');
                });
            }
        });
    }

    // Update selected items display
    function updateSelectedItems(container) {
        const selectedItems = container.querySelector('.dropdown-selected-items');
        const options = container.querySelectorAll('.dropdown-option.selected');
        const selectText = container.querySelector('.dropdown-select span');
        
        selectedItems.innerHTML = '';
        
        if (options.length === 0) {
            selectText.textContent = 'Select columns';
            return;
        }
        
        if (options.length <= 3) {
            options.forEach(option => {
                const item = document.createElement('div');
                item.className = 'dropdown-selected-item';
                item.innerHTML = `
                    <span>${option.querySelector('span').textContent}</span>
                    <span class="dropdown-selected-item-remove" data-value="${option.dataset.value}">×</span>
                `;
                selectedItems.appendChild(item);
            });
            selectText.textContent = 'Selected';
        } else {
            selectText.textContent = `${options.length} items selected`;
        }
        
        // Add event listeners to remove buttons
        selectedItems.querySelectorAll('.dropdown-selected-item-remove').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                const value = btn.dataset.value;
                const option = container.querySelector(`.dropdown-option[data-value="${value}"]`);
                option.classList.remove('selected');
                updateSelectedItems(container);
            });
        });
    }

    // Select a node and show its config
    function selectNode(nodeId) {
        selectedNodeId = nodeId;
        
        // Find the node data
        let nodeData;
        if (currentWorkflow === 'workflow1') {
            nodeData = workflow1Nodes.find(node => node.id === nodeId);
        } else if (currentWorkflow === 'workflow2') {
            nodeData = workflow2Nodes.find(node => node.id === nodeId);
        } else {
            nodeData = workflow3Nodes.find(node => node.id === nodeId);
        }
        
        if (!nodeData) return;
        
        // Update config panel
        configTitle.innerHTML = `
            <div class="node-icon ${nodeData.type}">
                ${nodeData.icon}
            </div>
            ${nodeData.name}
        `;
        
        configContent.innerHTML = nodeData.config;
        configPanel.classList.add('active');
        
        // Initialize dropdowns in the config panel
        initDropdowns();
        
        // Update selected node in UI
        if (currentWorkflow === 'workflow1') {
            renderWorkflow1();
        } else if (currentWorkflow === 'workflow2') {
            renderWorkflow2();
        } else {
            renderWorkflow3();
        }
    }

    // Open the output modal for a node
    function openOutputModal(nodeId) {
        const modalId = `output-modal-${nodeId}`;
        const modalElement = document.getElementById(modalId);
        if (modalElement) {
            modalElement.classList.add('active');
        }
    }

    // Close the output modal
    function closeOutputModal(modalId) {
        const modalElement = document.getElementById(modalId);
        if (modalElement) {
            modalElement.classList.remove('active');
        }
    }

    // Close the config panel
    function closeConfigPanel() {
        configPanel.classList.remove('active');
        selectedNodeId = null;
        if (currentWorkflow === 'workflow1') {
            renderWorkflow1();
        } else if (currentWorkflow === 'workflow2') {
            renderWorkflow2();
        } else {
            renderWorkflow3();
        }
    }

    // Simulate running the workflow with sequential node highlighting
    function runWorkflow() {
        runOverlay.classList.add('active');
        
        // Get the current workflow container
        const currentContainer = currentWorkflow === 'workflow1' ? workflowContainer1 : 
                                (currentWorkflow === 'workflow2' ? workflowContainer2 : workflowContainer3);
        
        // Reset all nodes
        currentContainer.querySelectorAll('.workflow-node').forEach(node => {
            node.classList.remove('node-active');
            node.classList.remove('completed');
        });
        
        // Run through each node sequentially
        const nodes = currentContainer.querySelectorAll('.workflow-node');
        let currentNodeIndex = 0;
        
        function activateNextNode() {
            if (currentNodeIndex > 0) {
                nodes[currentNodeIndex - 1].classList.remove('node-active');
                // Mark previous node as completed (shows blue dot)
                nodes[currentNodeIndex - 1].classList.add('completed');
            }
            
            if (currentNodeIndex < nodes.length) {
                nodes[currentNodeIndex].classList.add('node-active');
                currentNodeIndex++;
                setTimeout(activateNextNode, 800);
            } else {
                // Workflow complete
                setTimeout(() => {
                    runOverlay.classList.remove('active');
                }, 500);
            }
        }
        
        // Start the sequence after a short delay
        setTimeout(activateNextNode, 500);
    }

    // Event Listeners
    closeConfig.addEventListener('click', closeConfigPanel);
    runBtn.addEventListener('click', runWorkflow);

    // Initialize the workflow
    document.addEventListener('DOMContentLoaded', initWorkflow);
</script>
</body>
</html>